<!DOCTYPE html>
<html lang="ja">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <head>
        <script type="text/javascript" src="jquery-2.1.3.min.js"></script>
    </head>
    <body>
        <div>
            抽選曲数
            <select id="selectCount">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4" selected>4</option>
            </select>
        </div>
        <div id="main">
        </div>
        <br>
        <div style="width:400px; height:100px; margin:0 auto 0 auto;">
            <button style="width:400px; height:50px; margin:0 auto 0 auto;" onclick="select();">抽選</button>
        </div>

        <script type="text/javascript">
            data = [];
            var main = document.getElementById("main");
            count = 0;

            outputColumns = ["title", "product", "category", "artist", "year"];

            function select()
            {
                count += 1;

                var h1 = document.createElement("h1");
                h1.innerHTML = count;
                main.appendChild(h1);

                var div = document.createElement("div");
                main.appendChild(div);

                var selectCount = Number($("#selectCount").val());
                for(var i=0 ; i<selectCount; ++i)
                {
                    var index = Math.floor(Math.random() * data.length);
                    var record = data[index];
                    data.splice(index, 1)

                    var d = document.createElement("div");
                    div.appendChild(d);

                    d.style.backgroundColor = "#eae5e3";

                    var h = document.createElement("h4");
                    h.innerHTML = record["title"];
                    h.style.backgroundColor = "#f4dda5";
                    h.style.padding = "5px";
                    d.appendChild(h);

                    var str = "";
                    if (record["product"])
                    {
                        str += record["product"];
                    }
                    if (record["category"])
                    {
                        str += " " + record["category"];
                    }
                    if (record["artist"])
                    {
                        str += " （" + record["artist"] + "）";
                    }
                    if (record["year"])
                    {
                        str += " - " + record["year"];
                    }
                    var p = document.createElement("p");
                    d.appendChild(p);
                    p.style.padding = "5px";
                    p.innerHTML = str;
                }
                var hr = document.createElement("hr");
                main.appendChild(hr);
            }

            function concatJson(json)
            {
                Array.prototype.push.apply(data, json);
            }
        </script>

        <!-- ここから曲データベース -->
        <script type="text/javascript" src="anison.txt"></script>
        <!-- ここまで曲データベース -->

        <script type="text/javascript">
            var p = document.createElement("p");
            p.innerHTML = "現在" + data.length + "曲登録";
            document.getElementById("main").appendChild(p);
        </script>
    </body>
<html>


